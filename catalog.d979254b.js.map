{"mappings":"oeAAAA,EAAA,S,iCCAA,IAAAC,EAAAD,EAAA,S,oDAMA,MAAME,EAAaC,SAASC,cAAc,gBACpCC,EAAYF,SAASC,cAAc,kBACnCE,EAAUH,SAASC,cAAc,qBACjCG,EAAmBJ,SAASC,cAAc,uBAC1CI,EAAW,IAAI,EAAAP,EAAAQ,mBAErBP,EAAWQ,iBAAiB,UAE5BC,eAAwBC,GACtBA,EAAEC,iBAEF,MAAMC,EAAYF,EAAEG,cAAcC,SAASC,YAAYC,MAAMC,OAI7D,GAHAb,EAAQc,UAAUC,IAAI,aAGJ,KAAdP,EAQF,OAPAP,EAAiBa,UAAUC,IAAI;AAC/BhB,EAAUiB,UAAY,GACtBC,SAASC,OAAOC,QACd,mEAGFvB,EAAWwB,QAIbrB,EAAUiB,UAAY,GACtBd,EAASmB,MAAQb,EAEjB,MAAMc,QAAmBpB,EAASqB,eAC5BC,GAAa,EAAAC,EAAAC,kBACjBJ,EAAWK,cACXL,EAAWM,aAEPC,QAAsBP,EAAWQ,QAAQC,MAAM,EAAG,IAExD,IACMF,EAAcG,OAAS,IACzB,EAAArC,EAAAsC,aAAYC,MAAKC,IACfC,EAAOC,OAASF,EAEhB,MAAMG,GAAe,EAAAC,EAAAC,uBAAsBX,GAC3C9B,EAAUiB,UAAYsB,GACtB,EAAAG,EAAAC,aAAY,IAEdzC,EAAiBa,UAAU6B,OAAO,mBAElCnB,EAAWoB,GAAG,cAAc,EAACC,KAAEA,MAE7B3C,EAASqB,aAAasB,GAAMX,MAAKC,IAC/B,MAAMW,EAASX,EAAKL,QAAQC,MAAM,EAAG,IAErC,GAAIe,EAAQ,CACV7C,EAAiBa,UAAU6B,OAAO,mBAClC,MAAMI,GAAqB,EAAAR,EAAAC,uBAAsBM,GACjD/C,EAAUiB,UAAY+B,GACtB,EAAAN,EAAAC,cACAM,OAAOC,SAAS,CACdC,IAAK,IACLC,SAAU,U,IAGd,MAGJnD,EAAQc,UAAU6B,OAAO,aACzB1C,EAAiBa,UAAUC,IAAI,mB,CAEjC,MAAOqC,GACPC,QAAQC,IAAIF,EAAMG,Q,CACnB,QACC3D,EAAWwB,O","sources":["src/catalog.js","src/scripts/search-films.js"],"sourcesContent":["import './scripts/theme-switch';\nimport './scripts/hero';\nimport './scripts/getWeekTrendingMoviesInCatalog';\nimport './scripts/modal-window';\nimport './scripts/search-films';\n","import { CatalogApiService, searchMovies } from './movies-api';\nimport { createMarkupFilmsList } from './markup';\nimport { starRating } from './star-rating';\nimport { createPagination } from './pagination';\nimport { getGenres } from './movies-api';\n\nconst searchForm = document.querySelector('.search-form');\nconst movieList = document.querySelector('.catalog__list');\nconst message = document.querySelector('.catalog__message');\nconst paginationHidden = document.querySelector('.catalog-pagination');\nconst movieAPI = new CatalogApiService();\n\nsearchForm.addEventListener('submit', onSearch);\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  const formValue = e.currentTarget.elements.searchQuery.value.trim();\n  message.classList.add('is-hidden');\n  // paginationHidden.classList.remove('visually-hidden');\n\n  if (formValue === '') {\n    paginationHidden.classList.add('visually-hidden'); //!\n    movieList.innerHTML = '';\n    Notiflix.Notify.failure(\n      \"Sorry, the search string can't be empty. Please try again.\"\n    );\n\n    searchForm.reset();\n    return;\n  }\n\n  movieList.innerHTML = '';\n  movieAPI.query = formValue;\n\n  const dataSearch = await movieAPI.searchMovies();\n  const pagination = createPagination(\n    dataSearch.total_results,\n    dataSearch.total_pages\n  ); // TODO pagination\n  const searchResults = await dataSearch.results.slice(0, 10);\n\n  try {\n    if (searchResults.length > 0) {\n      getGenres().then(data => {\n        global.genres = data;\n\n        const markupMovies = createMarkupFilmsList(searchResults);\n        movieList.innerHTML = markupMovies;\n        starRating();\n      });\n      paginationHidden.classList.remove('visually-hidden');\n\n      pagination.on('beforeMove', ({ page }) => {\n        // movieList.innerHTML = '';\n        movieAPI.searchMovies(page).then(data => {\n          const movies = data.results.slice(0, 10);\n\n          if (movies) {\n            paginationHidden.classList.remove('visually-hidden');\n            const markupSearchMovies = createMarkupFilmsList(movies);\n            movieList.innerHTML = markupSearchMovies;\n            starRating();\n            window.scrollTo({\n              top: 450,\n              behavior: 'smooth',\n            });\n          }\n        });\n      });\n    } else {\n      message.classList.remove('is-hidden');\n      paginationHidden.classList.add('visually-hidden');\n    }\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    searchForm.reset();\n  }\n}\n"],"names":["parcelRequire","$abWUW","$95a4480601400133$var$searchForm","document","querySelector","$95a4480601400133$var$movieList","$95a4480601400133$var$message","$95a4480601400133$var$paginationHidden","$95a4480601400133$var$movieAPI","CatalogApiService","addEventListener","async","e","preventDefault","formValue","currentTarget","elements","searchQuery","value","trim","classList","add","innerHTML","Notiflix","Notify","failure","reset","query","dataSearch","searchMovies","pagination","$kZwB7","createPagination","total_results","total_pages","searchResults","results","slice","length","getGenres","then","data","$parcel$global","genres","markupMovies","$54vKW","createMarkupFilmsList","$55Csz","starRating","remove","on","page","movies","markupSearchMovies","window","scrollTo","top","behavior","error","console","log","message"],"version":3,"file":"catalog.d979254b.js.map"}