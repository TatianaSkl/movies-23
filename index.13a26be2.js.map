{"mappings":"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","sources":["src/scripts/hero.js","src/scripts/modal-window.js"],"sourcesContent":["import { getDayTrendingMovies, getMovieVideos } from './movies-api';\nimport { starRating } from './star-rating';\n\nconst heroBg = document.getElementById('hero-bg');\nconst heroContent = document.getElementById('hero-content');\nconst heroWrapper = document.getElementById('hero__wrapper');\nconst heroMovie = document.getElementById('hero-movie');\nconst heroImage = document.getElementById('hero-image');\nconst heroMovieMob = document.getElementById('hero-movie-mob');\nconst modalHero = document.getElementById('modal-hero');\nconst closeModalHeroBtn = document.getElementById('modal-hero-close');\nconst modalError = document.querySelector('.modal-error');\n\ncloseModalHeroBtn.addEventListener('click', onCloseModal);\nmodalHero.addEventListener('click', onBackdropClick);\n\nexport function renderHero() {\n  getDayTrendingMovies().then(data => {\n    try {\n      const movies = data.results;\n      if (movies.length === 0) {\n        heroMovie.classList.add('visually-hidden');\n        return;\n      } else {\n        const randomIndex = Math.floor(Math.random() * movies.length);\n        const movie = movies[randomIndex];\n        const { backdrop_path, title, overview, vote_average, id } = movie;\n\n        heroBg.style.backgroundImage = `linear-gradient(87.8deg, #0e0e0e 15.61%, rgba(14, 14, 14, 0) 60.39%),url('https://image.tmdb.org/t/p/original/${backdrop_path}')`;\n        heroImage.style.backgroundImage = `url('https://image.tmdb.org/t/p/original/${backdrop_path}')`;\n        heroMovieMob.innerHTML = `\n        <h1 class=\"hero__title-movie\">${title}</h1>\n        <div class=\"hero__wrapper-rating\">\n        <span class=\"hero-card__rating\">\n      <div class=\"rating hero-rating\">\n        <div class=\"hero-rating__body\">\n          <div class=\"rating__active\"></div>\n          <div class=\"hero-rating__items\">\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"10\"\n              class=\"rating__item\"\n              value=\"${vote_average}\"\n              name=\"hero-rating\"\n            />\n          </div>\n        </div>\n      </div>\n    </span>\n    </div>\n        <p class=\"hero__text-movie\">${overview}</p>\n        <button class=\"btn hero__btn-movie\" id=\"modal-hero-open-mob\">Watch trailer</button>\n      `;\n        starRating();\n        heroMovie.innerHTML = `\n        <h1 class=\"hero__title-movie\">${title}</h1>\n        <div class=\"hero__wrapper-rating\">\n        <span class=\"hero-card__rating\">\n      <div class=\"rating hero-rating\">\n        <div class=\"hero-rating__body\">\n          <div class=\"rating__active\"></div>\n          <div class=\"hero-rating__items\">\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"10\"\n              class=\"rating__item\"\n              value=\"${vote_average}\"\n              name=\"hero-rating\"\n            />\n          </div>\n        </div>\n      </div>\n    </span>\n    </div>\n        <p class=\"hero__text-movie\">${overview}</p>\n        <button class=\"btn hero__btn-movie\" id=\"modal-hero-open\">Watch trailer</button>\n      `;\n        starRating();\n        const openModalHeroBtn = document.getElementById('modal-hero-open');\n        const openModalHeroBtnMob = document.getElementById('modal-hero-open-mob');\n        openModalHeroBtn.addEventListener('click', () => {\n          showMovieTrailer(id);\n          onOpenModal();\n        });\n        openModalHeroBtnMob.addEventListener('click', () => {\n          showMovieTrailer(id);\n          onOpenModal();\n        });\n\n        function onOpenModal() {\n          window.addEventListener('keydown', onEscKeyPress);\n          modalHero.classList.remove('hero-is-hidden');\n        }\n        heroContent.classList.add('visually-hidden');\n        heroWrapper.classList.add('visually-hidden');\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  });\n}\nexport function onEscKeyPress(e) {\n  if (e.code === 'Escape') {\n    onCloseModal();\n  }\n}\nexport function onBackdropClick(e) {\n  if (e.currentTarget === e.target) {\n    onCloseModal();\n  }\n}\nexport function onCloseModal() {\n  window.removeEventListener('keydown', onEscKeyPress);\n  modalHero.classList.add('hero-is-hidden');\n}\n\nexport function showMovieTrailer(movieId) {\n  try {\n    getMovieVideos(movieId).then(data => {\n      const videos = data.results.filter(video => video.type === 'Trailer');\n      if (videos.length === 0) {\n        return;\n      }\n      const videoKey = videos[0].key;\n      const trailerUrl = `https://www.youtube.com/embed/${videoKey}`;\n      const modalVideo = document.querySelector('.modal-video');\n      modalVideo.innerHTML = `<iframe src=\"${trailerUrl}\" title=\"YouTube video player\"\n          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share;\"\n          allowfullscreen></iframe>`;\n      modalError.classList.add('hero-is-hidden');\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderHero();\n});\n","import { getMovieDetails } from './movies-api';\n\nconst filmCards = document.querySelector('.js-film');\nconst modBackdrop = document.querySelector('.modal-backdrop');\nconst closeBtn = document.querySelector('.modal__close-btn');\nconst modalRef = document.querySelector('.modal__wrap');\nconst modalListRef = document.querySelector('.cards-film');\n\nconst LibKey = 'myLibrary';\n\nfilmCards.addEventListener('click', onOpenModal);\ncloseBtn.addEventListener('click', onCloseModal);\nmodBackdrop.addEventListener('click', onBackDropClick);\n\n// TODO: Открываем модалку\nexport function onOpenModal(event) {\n  const getParentalEl = event.target.closest('.js-card');\n\n  if (!getParentalEl) {\n    return;\n  }\n\n  // записываем id\n  const movieId = getParentalEl.dataset.id;\n\n  loadIntoModal(movieId);\n\n  modBackdrop.classList.remove('is-hidden');\n  document.body.classList.add('modal-open');\n  window.addEventListener('keydown', onEscKeyPress);\n}\n\n// закрываем модалку\nfunction onCloseModal() {\n  modalListRef.innerHTML = '';\n  document.body.classList.remove('modal-open');\n  modBackdrop.classList.add('is-hidden');\n}\n\n// закрываем по клику на backdrop\nfunction onBackDropClick(event) {\n  if (event.currentTarget === event.target) {\n    onCloseModal();\n  }\n}\n\n// закрываем по нажатию Escape\nfunction onEscKeyPress(event) {\n  if (event.code === 'Escape') {\n    onCloseModal();\n    window.removeEventListener('keydown', onEscapeKeyboard);\n  }\n}\n\nfunction addToLibraryFilm(data) {\n  const library = JSON.parse(localStorage.getItem(LibKey)) || [];\n\n  library.push(data);\n  localStorage.setItem(LibKey, JSON.stringify(library));\n}\n\n// загружаем карточку в модалку\n\nexport async function loadIntoModal(idMovie) {\n  const library = JSON.parse(localStorage.getItem(LibKey)) || [];\n\n  const filmIdsArr = library.map(item => item.id);\n\n\n  try {\n    const data = await getMovieDetails(idMovie);\n\n    const createModalCard = createCardMarkup(data);\n    modalListRef.innerHTML = createModalCard;\n\n    const filmAddBtn = document.querySelector('.film-add__btn');\n\n    if (filmIdsArr.includes(Number(idMovie))) {\n      filmAddBtn.textContent = 'Remove from my library';\n    } else {\n      filmAddBtn.textContent = 'Add to my library';\n    }\n\n    filmAddBtn.addEventListener('click', () => {\n      if (filmAddBtn.textContent === 'Add to my library') {\n        addToLibraryFilm(data);\n\n        filmAddBtn.textContent = 'Remove from my library';\n      } else {\n        // получаем массив фильмов из хранилища\n        const library = JSON.parse(localStorage.getItem(LibKey)) || [];\n       \n        // находим фильм по id\n        const filmLS = library.find(item => item.id === data.id);\n       \n        // определяем индекс филма в массиве\n        const indexFilm = library.indexOf(filmLS);\n        \n        // удаляем фильм из массива\n        const deleteFilm = library.splice(indexFilm, 1);\n        \n        // сохраняем новый массив в хранилище\n        localStorage.setItem(LibKey, JSON.stringify(library));\n        filmAddBtn.textContent = 'Add to my library';\n        return;\n        \n      }\n    });\n  } catch (err) {\n    modalListRef.innerHTML =\n      '<div class=\"modal__empty\">Sorry, info is unavailable</div>';\n    return;\n  }\n}\n\n// рендерим разметку в карточку\nfunction createCardMarkup(data) {\n  const {\n    original_title,\n    id,\n    genre_names,\n    genres,\n    vote_average,\n    poster_path,\n    overview,\n    popularity,\n    vote_count,\n  } = data;\n\n  const genreName = genres ? genres.map(genre => genre.name) : [];\n  const genresList = genreName.slice(0, 2).join(', ');\n\n  return `<li class=\"film--add\" data-id=\"${id}\">\n  <div class=\"film-add__wrap\">\n    <img class=\"film-add__img\" src=\"https://image.tmdb.org/t/p/original/${poster_path}\" alt=\"${original_title}\" loading=\"lazy\" />\n  </div>\n  <div class=\"film-add__desc\">\n    <h2 class=\"film-add__title\">${original_title}</h2>\n\n    <ul class=\"film-add__list list\">\n      <li class=\"film-add__item\">\n        <span class=\"film-add__subtitle\">Vote / Votes</span\n        ><span class=\"film-add__span votes average\"\n          >${vote_average}</span> / <span class=\"film-add__span votes count\"\n          >${vote_count}</span>\n      </li>\n      <li class=\"film-add__item\">\n        <span class=\"film-add__subtitle\">Popularity</span\n        ><span class=\"film-add__span\">${popularity}</span>\n      </li>\n      <li class=\"film-add__item\">\n        <span class=\"film-add__subtitle\">Genre</span\n        ><span class=\"film-add__span genres\">${genresList}</span>\n      </li>\n    </ul>\n\n    <div class=\"film-add__wrap-desc\">\n      <h3 class=\"film-add__about\">About</h3>\n      <p class=\"film-add__text\">${overview}</p>\n    </div>\n\n    <button type=\"button\" class=\"film-add__btn btn\">Add to my library</button>\n  </div>\n</li>`;\n}\n"],"names":["$abWUW","parcelRequire","$13bd0e14f5b7c06d$var$heroBg","document","getElementById","$13bd0e14f5b7c06d$var$heroContent","$13bd0e14f5b7c06d$var$heroWrapper","$13bd0e14f5b7c06d$var$heroMovie","$13bd0e14f5b7c06d$var$heroImage","$13bd0e14f5b7c06d$var$heroMovieMob","$13bd0e14f5b7c06d$var$modalHero","$13bd0e14f5b7c06d$var$closeModalHeroBtn","$13bd0e14f5b7c06d$var$modalError","querySelector","$13bd0e14f5b7c06d$export$fb6b6f6d7754d13b","e","code","$13bd0e14f5b7c06d$export$9dc820945641dd09","window","removeEventListener","classList","add","$13bd0e14f5b7c06d$export$8640f99dfcd1c228","movieId","getMovieVideos","then","data","videos","results","filter","video","type","length","trailerUrl","key","innerHTML","error","console","addEventListener","currentTarget","target","getDayTrendingMovies","movies","movie","Math","floor","random","backdrop_path","title","overview","vote_average","id","style","backgroundImage","$55Csz","starRating","openModalHeroBtn","openModalHeroBtnMob","onOpenModal","remove","$79ce555204270203$var$filmCards","$79ce555204270203$var$modBackdrop","$79ce555204270203$var$closeBtn","$79ce555204270203$var$modalListRef","$79ce555204270203$var$LibKey","$79ce555204270203$var$onCloseModal","body","$79ce555204270203$var$onEscKeyPress","event","onEscapeKeyboard","getParentalEl","closest","async","idMovie","filmIdsArr","JSON","parse","localStorage","getItem","map","item","getMovieDetails","createModalCard","original_title","genre_names","genres","poster_path","popularity","vote_count","genresList","genre","name","slice","join","$79ce555204270203$var$createCardMarkup","filmAddBtn","includes","Number","textContent","library","filmLS","find","indexFilm","indexOf","splice","setItem","stringify","push","$79ce555204270203$var$addToLibraryFilm","err","$79ce555204270203$export$de4b13aa6582d63d","dataset"],"version":3,"file":"index.13a26be2.js.map"}