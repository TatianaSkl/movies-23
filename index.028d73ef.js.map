{"mappings":"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","sources":["src/scripts/hero.js","src/scripts/modal-window.js"],"sourcesContent":["import { getDayTrendingMovies, getMovieVideos } from './movies-api';\nimport { starRating } from './star-rating';\n\nconst heroBg = document.getElementById('hero-bg');\nconst heroContent = document.getElementById('hero-content');\nconst heroWrapper = document.getElementById('hero__wrapper');\nconst heroMovie = document.getElementById('hero-movie');\nconst heroImage = document.getElementById('hero-image');\nconst heroMovieMob = document.getElementById('hero-movie-mob');\nconst modalHero = document.getElementById('modal-hero');\nconst closeModalHeroBtn = document.getElementById('modal-hero-close');\nconst modalError = document.querySelector('.modal-error');\n\ncloseModalHeroBtn.addEventListener('click', onCloseModal);\nmodalHero.addEventListener('click', onBackdropClick);\n\nexport function renderHero() {\n  getDayTrendingMovies().then(data => {\n    try {\n      const movies = data.results;\n      if (movies.length === 0) {\n        heroMovie.classList.add('visually-hidden');\n        return;\n      } else {\n        const randomIndex = Math.floor(Math.random() * movies.length);\n        const movie = movies[randomIndex];\n        const { backdrop_path, title, overview, vote_average, id } = movie;\n\n        heroBg.style.backgroundImage = `linear-gradient(87.8deg, #0e0e0e 15.61%, rgba(14, 14, 14, 0) 60.39%),url('https://image.tmdb.org/t/p/original/${backdrop_path}')`;\n        heroImage.style.backgroundImage = `url('https://image.tmdb.org/t/p/original/${backdrop_path}')`;\n        heroMovieMob.innerHTML = `\n        <h1 class=\"hero__title-movie\">${title}</h1>\n        <div class=\"hero__wrapper-rating\">\n        <span class=\"hero-card__rating\">\n      <div class=\"rating hero-rating\">\n        <div class=\"hero-rating__body\">\n          <div class=\"rating__active\"></div>\n          <div class=\"hero-rating__items\">\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"10\"\n              class=\"rating__item\"\n              value=\"${vote_average}\"\n              name=\"hero-rating\"\n            />\n          </div>\n        </div>\n      </div>\n    </span>\n    </div>\n        <p class=\"hero__text-movie\">${overview}</p>\n        <button class=\"btn hero__btn-movie\" id=\"modal-hero-open-mob\">Watch trailer</button>\n      `;\n        starRating();\n        heroMovie.innerHTML = `\n        <h1 class=\"hero__title-movie\">${title}</h1>\n        <div class=\"hero__wrapper-rating\">\n        <span class=\"hero-card__rating\">\n      <div class=\"rating hero-rating\">\n        <div class=\"hero-rating__body\">\n          <div class=\"rating__active\"></div>\n          <div class=\"hero-rating__items\">\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"10\"\n              class=\"rating__item\"\n              value=\"${vote_average}\"\n              name=\"hero-rating\"\n            />\n          </div>\n        </div>\n      </div>\n    </span>\n    </div>\n        <p class=\"hero__text-movie\">${overview}</p>\n        <button class=\"btn hero__btn-movie\" id=\"modal-hero-open\">Watch trailer</button>\n      `;\n        starRating();\n        const openModalHeroBtn = document.getElementById('modal-hero-open');\n        const openModalHeroBtnMob = document.getElementById('modal-hero-open-mob');\n        openModalHeroBtn.addEventListener('click', () => {\n          showMovieTrailer(id);\n          onOpenModal();\n        });\n        openModalHeroBtnMob.addEventListener('click', () => {\n          showMovieTrailer(id);\n          onOpenModal();\n        });\n\n        function onOpenModal() {\n          window.addEventListener('keydown', onEscKeyPress);\n          modalHero.classList.remove('hero-is-hidden');\n        }\n        heroContent.classList.add('visually-hidden');\n        heroWrapper.classList.add('visually-hidden');\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  });\n}\nexport function onEscKeyPress(e) {\n  if (e.code === 'Escape') {\n    onCloseModal();\n  }\n}\nexport function onBackdropClick(e) {\n  if (e.currentTarget === e.target) {\n    onCloseModal();\n  }\n}\nexport function onCloseModal() {\n  window.removeEventListener('keydown', onEscKeyPress);\n  modalHero.classList.add('hero-is-hidden');\n}\n\nexport function showMovieTrailer(movieId) {\n  try {\n    getMovieVideos(movieId).then(data => {\n      const videos = data.results.filter(video => video.type === 'Trailer');\n      if (videos.length === 0) {\n        return;\n      }\n      const videoKey = videos[0].key;\n      const trailerUrl = `https://www.youtube.com/embed/${videoKey}`;\n      const modalVideo = document.querySelector('.modal-video');\n      modalVideo.innerHTML = `<iframe src=\"${trailerUrl}\" title=\"YouTube video player\"\n          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share;\"\n          allowfullscreen></iframe>`;\n      modalError.classList.add('hero-is-hidden');\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderHero();\n});\n","import { getMovieDetails } from './movies-api';\n\nconst filmCards = document.querySelector('.js-film');\nconst modBackdrop = document.querySelector('.modal-backdrop');\nconst closeBtn = document.querySelector('.modal__close-btn');\nconst modalRef = document.querySelector('.modal__wrap');\nconst modalListRef = document.querySelector('.cards-film');\n\nconst LibKey = 'myLibrary';\n\nfilmCards.addEventListener('click', onOpenModal);\ncloseBtn.addEventListener('click', onCloseModal);\nmodBackdrop.addEventListener('click', onBackDropClick);\n\n// TODO: Открываем модалку\nexport function onOpenModal(event) {\n  const getParentalEl = event.target.closest('.js-card');\n\n  if (!getParentalEl) {\n    return;\n  }\n\n  // записываем id\n  const movieId = getParentalEl.dataset.id;\n\n  loadIntoModal(movieId);\n\n  modBackdrop.classList.remove('is-hidden');\n  document.body.classList.add('modal-open');\n  window.addEventListener('keydown', onEscKeyPress);\n}\n\n// закрываем модалку\nfunction onCloseModal() {\n  modalListRef.innerHTML = '';\n  document.body.classList.remove('modal-open');\n  modBackdrop.classList.add('is-hidden');\n}\n\n// закрываем по клику на backdrop\nfunction onBackDropClick(event) {\n  if (event.currentTarget === event.target) {\n    onCloseModal();\n  }\n}\n\n// закрываем по нажатию Escape\nfunction onEscKeyPress(event) {\n  if (event.code === 'Escape') {\n    onCloseModal();\n    window.removeEventListener('keydown', onEscapeKeyboard);\n  }\n}\n\nfunction addToLibraryFilm(data) {\n  const library = JSON.parse(localStorage.getItem(LibKey)) || [];\n\n  library.push(data);\n  localStorage.setItem(LibKey, JSON.stringify(library));\n}\n\n// загружаем карточку в модалку\n\nexport async function loadIntoModal(idMovie) {\n  const library = JSON.parse(localStorage.getItem(LibKey)) || [];\n\n  const filmIdsArr = library.map(item => item.id);\n\n\n  try {\n    const data = await getMovieDetails(idMovie);\n\n    const createModalCard = createCardMarkup(data);\n    modalListRef.innerHTML = createModalCard;\n\n    const filmAddBtn = document.querySelector('.film-add__btn');\n\n    if (filmIdsArr.includes(Number(idMovie))) {\n      filmAddBtn.textContent = 'Remove from my library';\n    } else {\n      filmAddBtn.textContent = 'Add to my library';\n    }\n\n    filmAddBtn.addEventListener('click', () => {\n      if (filmAddBtn.textContent === 'Add to my library') {\n        addToLibraryFilm(data);\n\n        filmAddBtn.textContent = 'Remove from my library';\n      } else {\n        // получаем массив фильмов из хранилища\n        const library = JSON.parse(localStorage.getItem(LibKey)) || [];\n       \n        // находим фильм по id\n        const filmLS = library.find(item => item.id === data.id);\n       \n        // определяем индекс филма в массиве\n        const indexFilm = library.indexOf(filmLS);\n        \n        // удаляем фильм из массива\n        const deleteFilm = library.splice(indexFilm, 1);\n        \n        // сохраняем новый массив в хранилище\n        localStorage.setItem(LibKey, JSON.stringify(library));\n        filmAddBtn.textContent = 'Add to my library';\n        return;\n        \n      }\n    });\n  } catch (err) {\n    modalListRef.innerHTML =\n      '<div class=\"modal__empty\">Sorry, info is unavailable</div>';\n    return;\n  }\n}\n\n// рендерим разметку в карточку\nfunction createCardMarkup(data) {\n  const {\n    original_title,\n    id,\n    genre_names,\n    genres,\n    vote_average,\n    poster_path,\n    overview,\n    popularity,\n    vote_count,\n  } = data;\n\n  const genreName = genres ? genres.map(genre => genre.name) : [];\n  const genresList = genreName.slice(0, 2).join(', ');\n\n  return `<li class=\"film--add\" data-id=\"${id}\">\n  <div class=\"film-add__wrap\">\n    <img class=\"film-add__img\" src=\"https://image.tmdb.org/t/p/original/${poster_path}\" alt=\"${original_title}\" loading=\"lazy\" />\n  </div>\n  <div class=\"film-add__desc\">\n    <h2 class=\"film-add__title\">${original_title}</h2>\n\n    <ul class=\"film-add__list list\">\n      <li class=\"film-add__item\">\n        <span class=\"film-add__subtitle\">Vote / Votes</span\n        ><span class=\"film-add__span votes average\"\n          >${vote_average}</span> / <span class=\"film-add__span votes count\"\n          >${vote_count}</span>\n      </li>\n      <li class=\"film-add__item\">\n        <span class=\"film-add__subtitle\">Popularity</span\n        ><span class=\"film-add__span\">${popularity}</span>\n      </li>\n      <li class=\"film-add__item\">\n        <span class=\"film-add__subtitle\">Genre</span\n        ><span class=\"film-add__span genres\">${genresList}</span>\n      </li>\n    </ul>\n\n    <div class=\"film-add__wrap-desc\">\n      <h3 class=\"film-add__about\">About</h3>\n      <p class=\"film-add__text\">${overview}</p>\n    </div>\n\n    <button type=\"button\" class=\"film-add__btn btn\">Add to my library</button>\n  </div>\n</li>`;\n}\n"],"names":["$algKM","parcelRequire","$3b2fa88030976769$var$heroBg","document","getElementById","$3b2fa88030976769$var$heroContent","$3b2fa88030976769$var$heroWrapper","$3b2fa88030976769$var$heroMovie","$3b2fa88030976769$var$heroImage","$3b2fa88030976769$var$heroMovieMob","$3b2fa88030976769$var$modalHero","$3b2fa88030976769$var$closeModalHeroBtn","$3b2fa88030976769$var$modalError","querySelector","$3b2fa88030976769$export$fb6b6f6d7754d13b","e","code","$3b2fa88030976769$export$9dc820945641dd09","window","removeEventListener","classList","add","$3b2fa88030976769$export$8640f99dfcd1c228","movieId","getMovieVideos","then","data","videos","results","filter","video","type","length","videoKey","key","trailerUrl","concat","innerHTML","error","console","addEventListener","currentTarget","target","getDayTrendingMovies","movies","movie","Math","floor","random","backdrop_path","title","overview","vote_average","id","style","backgroundImage","$3hLJb","starRating","openModalHeroBtn","openModalHeroBtnMob","onOpenModal","remove","$bpxeT","$812f657fd04bc022$var$filmCards","$812f657fd04bc022$var$modBackdrop","$812f657fd04bc022$var$closeBtn","$812f657fd04bc022$var$modalListRef","$812f657fd04bc022$var$LibKey","$812f657fd04bc022$var$onCloseModal","body","$812f657fd04bc022$var$onEscKeyPress","event","onEscapeKeyboard","$812f657fd04bc022$var$addToLibraryFilm","library","JSON","parse","localStorage","getItem","push","setItem","stringify","$812f657fd04bc022$var$_loadIntoModal","$parcel$interopDefault","$2TvXO","mark","_callee","idMovie","library1","filmIdsArr","createModalCard","filmAddBtn","map","item","getMovieDetails","_ctx","sent","$812f657fd04bc022$var$createCardMarkup","includes","Number","textContent","filmLS","find","indexFilm","indexOf","splice","apply","this","arguments","original_title","genres","genre_names","poster_path","popularity","vote_count","genresList","genre","name","slice","join","getParentalEl","closest","$812f657fd04bc022$export$de4b13aa6582d63d","dataset"],"version":3,"file":"index.028d73ef.js.map"}